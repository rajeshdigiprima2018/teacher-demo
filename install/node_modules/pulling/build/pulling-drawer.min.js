!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("pulling",e):t.Pulling=e()}(this,function(){"use strict";function t(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function s(){this.constructor=t}t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}function d(t,e){if(!t)throw TypeError("Invalid arguments: "+e)}var p=["linear","ease","ease-in","ease-out","ease-in-out","step-start","step-end"],e=(m.create=function(t){var e=t.mode||Object.keys(m.modes)[0]||"drawer";if(m.modes[e])return new m.modes[e](t);t=Object.keys(m.modes).map(function(t){return'"'+t+'"'}).join(", ");throw TypeError("`mode` must be one of "+t)},m.prototype.emit=function(t,e){var n=this;this.handlers[t].forEach(function(t){return t.call(n,e)})},m.prototype.on=function(t,e){return this.handlers[t].push(e),this},m.prototype.off=function(t,e){return this.handlers[t]=e?this.handlers[t].filter(function(t){return t!==e}):[],this},m.prototype.open=function(t){var e=this;if(this.emit("beforeopen",t),this.disabled)return this;if(this.state.opened)return this;this.state.closed=!1,this.state.closing=!1,this.state.opening=!0,this.state.opened=!1,this.openPanelClass&&document.documentElement.classList.add(this.openPanelClass);t=this.offset();0<t&&(n=this.timing*(1-t/this.width)+"ms",this.menu.style.transitionDuration=n,this.panel.style.transitionDuration=n),Object.assign(this.menu.style,this.styles.open.menu),Object.assign(this.panel.style,this.styles.open.panel);var n=function(){e.state.opening=!1,e.state.opened=!0,Object.assign(e.menu.style,e.styles.open.menu),Object.assign(e.panel.style,e.styles.open.panel),e.emit("opened")};return t===this.width?n():this.afterTransitionend(n),this},m.prototype.close=function(t){var e=this;if(this.emit("beforeclose",t),this.disabled)return this;if(this.state.closed)return this.state.closing=!1,this;this.state.closed=!1,this.state.closing=!0,this.state.opening=!1,this.state.opened=!1;t=this.offset();0<t&&(n=this.timing*t/this.width+"ms",this.menu.style.transitionDuration=n,this.panel.style.transitionDuration=n),Object.assign(this.menu.style,this.styles.closed.menu),Object.assign(this.panel.style,this.styles.closed.panel);var n=function(){e.state.closing=!1,e.state.closed=!0,Object.assign(e.menu.style,e.styles.closed.menu),Object.assign(e.panel.style,e.styles.closed.panel),e.openPanelClass&&document.documentElement.classList.remove(e.openPanelClass),e.emit("closed")};return 0===t?n():this.afterTransitionend(n),this},m.prototype.toggle=function(t){return!0===t?this.open():!1===t?this.close():this.toggle(this.state.closed||this.state.closing),this},m.prototype.disable=function(){return this.disabled=!0,this},m.prototype.enable=function(){return this.disabled=!1,this},m.prototype.afterTransitionend=function(t){},m.prototype.offset=function(){return 0},m.modes={},m);function m(t){var e=this;if(this.styles={base:{menu:{},panel:{}},open:{menu:{},panel:{}},closed:{menu:{},panel:{}}},this.handlers={beforeclose:[],closed:[],beforeopen:[],opened:[],touchstart:[],touchmove:[],touchend:[]},this.state={opened:!1,opening:!1,closed:!0,closing:!1},this.disabled=!1,!Object.values(m.modes).some(function(t){return e instanceof t}))throw TypeError("Calling this constructor is not allowed. Use `Pulling.create` instead");var n=t.menu,s=t.panel,o=t.side,i=t.mode,r=t.margin,u=t.timing,a=t.timingFunction,h=t.width,c=t.sensitivity,l=t.slope,t=(t.touch,t.openPanelClass);this.menu=n,this.panel=s,this.side=o||"left",this.mode=i||"drawer",this.margin=r||25,this.timing=u||200,this.timingFunction=a||"ease",this.width=h||256,this.sensitivity=c||.25,this.slope=l||.5,this.openPanelClass=t||null,d(n instanceof Element,"`menu` must be of type `Element`"),d(s instanceof Element,"`panel` must be of type `Element`"),d("left"===this.side||"right"===this.side,'`side` must be equal to "left" or "right"'),d("number"==typeof this.margin,'`margin` must be of type "number"'),d("number"==typeof this.timing,'`timing` must be of type "number"'),d(p.includes(this.timingFunction),"`timingFunction` must be one of "+p.map(function(t){return'"'+t+'"'}).join(", ")),d("number"==typeof this.width,'`width` must be of type "number"'),d("number"==typeof this.sensitivity,'`sensitivity` must be of type "number"'),d("number"==typeof this.slope,'`slope` must be of type "number"')}var n,s=(t(o,n=e),o.prototype.applyOffset=function(t){},o.prototype.initTouchEvents=function(){var i=this,t=this,r=t.width,o=t.margin,u=t.side,a=t.slope,h=t.sensitivity,c=t.menu,l=t.panel,d="left"===u?1:-1,p=0,m=0,f=0,y=0,g=0,v=0,b=0,E=!1,w=function(t){if(!t||t===document.documentElement||t===document.body)return!1;var e=getComputedStyle(t),n=e.overflowX,e=e.overflowY;return"auto"===n||"scroll"===n||"visible"===n&&"visible"!==e||w(t.parentElement)};return{onTouchstart:function(t){var e,n,s=t.target;i.ignoreSelector&&s.matches(i.ignoreSelector)||i.ignoreScrollables&&w(s)||(i.emit("touchstart",t),i.disabled||(i.touched=!1,1===t.touches.length&&(e=(n=t.touches[0]).clientX,s=n.clientY,t=i.offset(),n=o+t,("left"===u&&e<=n||"right"===u&&window.innerWidth-e<=n)&&(i.touched=!0,m=s,f=p=e,y=t,v=Date.now(),E=!0))))},onTouchmove:function(t){if(i.emit("touchmove",t),!i.disabled&&i.touched){var e=t.touches[0],n=e.clientX,t=e.clientY,e=(n-p)*d;if(!(Math.abs(e)<10)){if(E){var s=Math.abs((t-m)/e);if(a<s)return void(i.touched=!1);(i.state.closed&&0<e||i.state.opened)&&i.emit("beforeopen"),c.style.transition="",l.style.transition=""}if(i.state.opened&&0<e||i.state.closed&&e<0)return f=n,void(v=Date.now());i.state.opened=!1,i.state.closed=!1;s=0<(n-f)*d;i.state.opening=s,i.state.closing=!s;e=Math.min(Math.max(0,y+e),r);i.applyOffset(e),b=f,f=n,g=v,v=Date.now(),E=!1}}},onTouchend:function(t){var e,n,s,o;i.touched&&(i.touched=!1,E||(i.emit("touchend",t),Object.assign(i.panel.style,i.styles.base.panel),Object.assign(i.menu.style,i.styles.base.menu),e=i.offset(),o=(n=t.changedTouches[0].clientX)===f?(s=b,g):(s=f,v),o=(n-s)/(Date.now()-o)*d,r/2<e&&-h<o||h<o?i.open(t):i.close(t)))}}},o.prototype.addTouchEvents=function(){this.touchEvents||(this.touchEvents=this.initTouchEvents()),document.documentElement.addEventListener("touchstart",this.touchEvents.onTouchstart,!1),document.documentElement.addEventListener("touchmove",this.touchEvents.onTouchmove,!1),document.documentElement.addEventListener("touchend",this.touchEvents.onTouchend,!1)},o.prototype.removeTouchEvents=function(){document.documentElement.removeEventListener("touchstart",this.touchEvents.onTouchstart),document.documentElement.removeEventListener("touchmove",this.touchEvents.onTouchmove),document.documentElement.removeEventListener("touchend",this.touchEvents.onTouchend)},o.prototype.ignore=function(t){return this.ignores.push(t),this.ignoreSelector=this.ignores.join(", "),this},o.prototype.unignore=function(e){return this.ignores=this.ignores.filter(function(t){return t!==e}),this.ignoreSelector=this.ignores.join(", "),this},o.prototype.enableTouch=function(){return this.touch||(this.addTouchEvents(),this.touch=!0),this},o.prototype.disableTouch=function(){return this.touch&&(this.removeTouchEvents(),this.touch=!1),this},o);function o(t){var e=n.call(this,t)||this;return e.touched=!1,e.ignores=[],e.ignoreSelector="",e.touch=!1!==t.touch,e.ignoreScrollables=!1!==t.ignoreScrollables,e.touch&&e.addTouchEvents(),e}var i,e=(t(r,i=s),r.prototype.offset=function(){var t=this.menu.getBoundingClientRect();return"left"===this.side?t.left+this.width:window.innerWidth-t.left},r.prototype.applyOffset=function(t){var e="left"===this.side?1:-1;this.menu.style.transform="translateX("+t*e+"px)"},r.prototype.afterTransitionend=function(t){this.onTransitionend=t},r.prototype.initTransitionend=function(){var t=this;this.menu.addEventListener("transitionend",function(){t.onTransitionend&&t.onTransitionend(),t.onTransitionend=null},!1)},r);function r(t){var e=i.call(this,t)||this;return e.styles.base.menu=((t={transition:"transform "+e.timing+"ms "+e.timingFunction,overflowX:"hidden",overflowY:"auto",position:"fixed"})[e.side]="-"+e.width+"px",t.top="0",t.bottom="0",t.width=e.width+"px",t.zIndex="1",t),e.styles.open.menu={transform:"translateX("+("right"===e.side?"-":"")+e.width+"px)"},e.styles.closed.menu={transform:"translateX(0)"},Object.assign(e.menu.style,e.styles.base.menu,e.styles.closed.menu),Object.assign(e.panel.style,e.styles.base.panel,e.styles.closed.panel),e.initTransitionend(),e}return s.modes.drawer=e,Element.prototype.matches=Element.prototype.matches||Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector,Object.entries=function(e){return Object.keys(e).map(function(t){return[t,e[t]]})},Object.values=function(e){return Object.keys(e).map(function(t){return e[t]})},Object.assign=Object.assign||function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var s=0,o=e;s<o.length;s++)for(var i=o[s],r=0,u=Object.entries(i);r<u.length;r++){var a=u[r],h=a[0],a=a[1];t[h]=a}return t},Array.prototype.includes=function(t){return-1!==this.indexOf(t)},s});
//# sourceMappingURL=pulling-drawer.min.js.map
